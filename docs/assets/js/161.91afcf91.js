(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{375:function(t,a,e){"use strict";e.r(a);var s=e(2),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("Python＋Docker＋Selenium＋Chromeで甘茶の音楽工房ウェブスクレイピングします．本稿では，seleniumの操作を検索しながら必要な工程を実装します．jupyterだと楽です．"),e("br")]),t._v(" "),e("ClientOnly",[e("CallInArticleAdsense")],1),t._v(" "),e("p",[t._v("作業用BGMとして"),e("a",{attrs:{href:"https://amachamusic.chagasi.com/image_kurai.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("甘茶の音楽工房"),e("OutboundLink")],1),t._v("の音楽をダウンロードして聞いていました．いい加減面倒臭くなってきたので，ウェブスクレイピングでダウンロードしていきます．"),e("br")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#seleniumの操作"}},[t._v("Seleniumの操作")]),e("ul",[e("li",[e("a",{attrs:{href:"#モジュール"}},[t._v("モジュール")])]),e("li",[e("a",{attrs:{href:"#ページソースの表示"}},[t._v("ページソースの表示")])]),e("li",[e("a",{attrs:{href:"#ページ一覧の取得"}},[t._v("ページ一覧の取得")])]),e("li",[e("a",{attrs:{href:"#webelementのソース取得"}},[t._v("WebElementのソース取得")])]),e("li",[e("a",{attrs:{href:"#mp3のダウンロード先のurl"}},[t._v("mp3のダウンロード先のURL")])]),e("li",[e("a",{attrs:{href:"#mp3のダウンロード"}},[t._v("mp3のダウンロード")])])])]),e("li",[e("a",{attrs:{href:"#まとめ"}},[t._v("まとめ")])]),e("li",[e("a",{attrs:{href:"#参考サイト"}},[t._v("参考サイト")])])])]),e("p"),t._v(" "),e("p",[e("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HBXCY+4DRW36+50+2HM5Z5",rel:"nofollow"}},[e("img",{attrs:{border:"0",width:"1000",height:"124",alt:"",src:"https://www27.a8.net/svt/bgt?aid=210508450265&wid=001&eno=01&mid=s00000000018015052000&mc=1"}})]),e("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www10.a8.net/0.gif?a8mat=3HBXCY+4DRW36+50+2HM5Z5",alt:""}})]),t._v(" "),e("p",[e("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HIN6N+3YAMCY+CO4+6BMG1",rel:"nofollow"}},[e("img",{attrs:{border:"0",width:"1000",height:"124",alt:"",src:"https://www23.a8.net/svt/bgt?aid=210821855239&wid=001&eno=01&mid=s00000001642001062000&mc=1"}})]),e("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www17.a8.net/0.gif?a8mat=3HIN6N+3YAMCY+CO4+6BMG1",alt:""}})]),t._v(" "),e("p",[e("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HIN6N+7FBNEA+4AQ0+5YJRM",rel:"nofollow"}},[t._v("全国630店舗以上！もみほぐし・足つぼ・ハンドリフレ・クイックヘッドのリラクゼーション店【りらくる】")]),e("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www15.a8.net/0.gif?a8mat=3HIN6N+7FBNEA+4AQ0+5YJRM",alt:""}})]),t._v(" "),e("h2",{attrs:{id:"seleniumの操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#seleniumの操作"}},[t._v("#")]),t._v(" Seleniumの操作")]),t._v(" "),e("h3",{attrs:{id:"モジュール"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#モジュール"}},[t._v("#")]),t._v(" モジュール")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# coding: UTF-8")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" urllib"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chrome"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Options\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selene"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("driver "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" SeleneDriver\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" webdriver_manager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" chrome_version\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" webdriver_manager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chrome "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ChromeDriverManager\n")])])]),e("h3",{attrs:{id:"ページソースの表示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ページソースの表示"}},[t._v("#")]),t._v(" ページソースの表示")]),t._v(" "),e("p",[t._v("seleniumでイメージ音楽のページソースを取得します．")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ページソースの表示")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page_source\n")])])]),e("h3",{attrs:{id:"ページ一覧の取得"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ページ一覧の取得"}},[t._v("#")]),t._v(" ページ一覧の取得")]),t._v(" "),e("p",[t._v("イメージ音楽のページから，2ページ目,3ページ目のURLを取得します．"),e("br"),t._v("\n2ページ目,3ページ目のURLを示すclass名のpagerは1箇所しかないので,find_element_by_class_nameを使います．単数形のelementですので注意してください．")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# classで指定(1つ：find_element_by_class_name)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ※ find_element!!")]),t._v("\nelement "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_class_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pager"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2ページ目,3ページ目のURLを示すtagを取得")]),t._v("\naPageTags "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_elements_by_tag_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tagから2ページ目,3ページ目のURLを取得")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" aPageTag "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" aPageTags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tagからhref要素を取得")]),t._v("\n    page_url "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" aPageTag"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_attribute"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'href'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page_url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"webelementのソース取得"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webelementのソース取得"}},[t._v("#")]),t._v(" WebElementのソース取得")]),t._v(" "),e("p",[t._v("find_element_by_class_name()で取得したWebElementのソースを確認します．")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_attribute"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'innerHTML'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# WebElementからhtmlを取得")]),t._v("\n")])])]),e("h3",{attrs:{id:"mp3のダウンロード先のurl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mp3のダウンロード先のurl"}},[t._v("#")]),t._v(" mp3のダウンロード先のURL")]),t._v(" "),e("p",[t._v("イメージ音楽のページから，各mp3のダウンロード先のURLを取得します．"),e("br"),t._v("\nイメージとしては，右クリックで「リンク先をダウンロード」する際の参照先となるURLを探す作業です．"),e("br"),t._v("\nmp3のURLを示すclass名のdownloadは複数箇所あるので,find_elements_by_class_nameを使います．複数形のelementsですので注意してください．．"),e("br"),t._v("\n取得した各mp3の詳細ページのURLを元にダウンロード先のURLに設定されていたので，ダウンロード先のURLはreplace()で置換して取得しました．")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# classで指定(複数：find_elements_by_class_name)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ※ find_elements!!")]),t._v("\nelements "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_elements_by_class_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"download"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" element "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" elements"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#print(element.get_attribute('innerHTML')) # WebElementからhtmlを取得")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mp3の詳細ページのURL,tagで取得")]),t._v("\n    aTag "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_tag_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mp3のダウンロードページのURL")]),t._v("\n    dlurl "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" aTag"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_attribute"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'href'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'music_'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mp3/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.html'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.mp3'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"mp3のダウンロード"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mp3のダウンロード"}},[t._v("#")]),t._v(" mp3のダウンロード")]),t._v(" "),e("p",[t._v("取得したmp3のURLからmp3ファイルをダウンロードします．イメージとしては，リンク先をダウンロードの作業です．")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("dlfile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bgm/'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" dlurl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 保存ファイル名")]),t._v("\nurllib"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urlretrieve"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dlurl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dlfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ダウンロード実行:要はリンク先をダウンロード")]),t._v("\n")])])]),e("h2",{attrs:{id:"まとめ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#まとめ"}},[t._v("#")]),t._v(" まとめ")]),t._v(" "),e("p",[t._v("ここまででおおよそのseleniumの操作を検索しながら，必要な工程を実装しました．次の記事でdef文でまとめようと思います．")]),t._v(" "),e("h2",{attrs:{id:"参考サイト"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考サイト"}},[t._v("#")]),t._v(" 参考サイト")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://qiita.com/Chanmoro/items/9a3c86bb465c1cce738a",target:"_blank",rel:"noopener noreferrer"}},[t._v("10分で理解する Selenium"),e("OutboundLink")],1),e("br"),t._v(" "),e("a",{attrs:{href:"https://qiita.com/kei0919/items/f6f696169c92c936374c",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dockerコンテナからseleniumを使ってスクレイピング"),e("OutboundLink")],1),e("br"),t._v(" "),e("a",{attrs:{href:"https://qiita.com/maroKanatani/items/e52984f37cc5474ccd98",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python×SeleniumでWebスクレイピング実践"),e("OutboundLink")],1),e("br"),t._v(" "),e("a",{attrs:{href:"https://qiita.com/mochio/items/dc9935ee607895420186",target:"_blank",rel:"noopener noreferrer"}},[t._v("Selenium webdriverよく使う操作メソッドまとめ"),e("OutboundLink")],1),e("br"),t._v(" "),e("a",{attrs:{href:"https://qiita.com/sikkim/items/447b72e6ec45849058cd",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker上でSeleniumとHeadless ChromeとPython3を動かす"),e("OutboundLink")],1),e("br"),t._v(" "),e("a",{attrs:{href:"https://engineeeer.com/python-selenium-webelement-get-html/",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Python】seleniumでWebElementからhtmlを取得する"),e("OutboundLink")],1),e("br"),t._v(" "),e("a",{attrs:{href:"https://qiita.com/memakura/items/f80d2e2c59514cfc14c9",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python + Selenium + Chrome でファイル保存まわり"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HBXCY+4DRW36+50+2HM5Z5",rel:"nofollow"}},[e("img",{attrs:{border:"0",width:"1000",height:"124",alt:"",src:"https://www27.a8.net/svt/bgt?aid=210508450265&wid=001&eno=01&mid=s00000000018015052000&mc=1"}})]),e("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www10.a8.net/0.gif?a8mat=3HBXCY+4DRW36+50+2HM5Z5",alt:""}})]),t._v(" "),e("p",[e("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HIN6N+3YAMCY+CO4+6BMG1",rel:"nofollow"}},[e("img",{attrs:{border:"0",width:"1000",height:"124",alt:"",src:"https://www23.a8.net/svt/bgt?aid=210821855239&wid=001&eno=01&mid=s00000001642001062000&mc=1"}})]),e("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www17.a8.net/0.gif?a8mat=3HIN6N+3YAMCY+CO4+6BMG1",alt:""}})]),t._v(" "),e("p",[e("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HIN6N+7FBNEA+4AQ0+5YJRM",rel:"nofollow"}},[t._v("全国630店舗以上！もみほぐし・足つぼ・ハンドリフレ・クイックヘッドのリラクゼーション店【りらくる】")]),e("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www15.a8.net/0.gif?a8mat=3HIN6N+7FBNEA+4AQ0+5YJRM",alt:""}})]),t._v(" "),e("ClientOnly",[e("CallInArticleAdsense")],1)],1)}),[],!1,null,null,null);a.default=n.exports}}]);