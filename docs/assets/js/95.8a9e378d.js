(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{482:function(t,a,s){"use strict";s.r(a);var e=s(2),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("Python + Google Colab + Spleeterで楽器と人の声を分離する音源分離を実装します．"),s("br")]),t._v(" "),s("ClientOnly",[s("CallInArticleAdsense")],1),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#google-colabのファイル構成"}},[t._v("Google Colabのファイル構成")])]),s("li",[s("a",{attrs:{href:"#google-driveと連携"}},[t._v("Google Driveと連携")])]),s("li",[s("a",{attrs:{href:"#ffmpeg-ibsndfileのインストール"}},[t._v("ffmpeg，ibsndfileのインストール")])]),s("li",[s("a",{attrs:{href:"#モジュールのインストール"}},[t._v("モジュールのインストール")])]),s("li",[s("a",{attrs:{href:"#サンプル音声のダウンロード"}},[t._v("サンプル音声のダウンロード")])]),s("li",[s("a",{attrs:{href:"#spleeterによる音響分離"}},[t._v("Spleeterによる音響分離")])]),s("li",[s("a",{attrs:{href:"#_5音源での音響分離"}},[t._v("5音源での音響分離")]),s("ul",[s("li",[s("a",{attrs:{href:"#音源"}},[t._v("音源")])]),s("li",[s("a",{attrs:{href:"#_5音源での音響分離"}},[t._v("5音源での音響分離")])])])]),s("li",[s("a",{attrs:{href:"#まとめ"}},[t._v("まとめ")])]),s("li",[s("a",{attrs:{href:"#参考サイト"}},[t._v("参考サイト")])])])]),s("p"),t._v(" "),s("p",[t._v("今回はGoogle ColabとGoogle Driveを連携させて，notebook形式で実行してます．"),s("br")]),t._v(" "),s("blockquote",[s("p",[t._v("Google Colaboratory（以下Google Colab）は、Google社が無料で提供している機械学習の教育や研究用の開発環境です。開発環境はJupyter Notebookに似たインターフェースを持ち、Pythonの主要なライブラリがプリインストールされています。"),s("br"),t._v("\n引用元："),s("a",{attrs:{href:"https://interface.cqpub.co.jp/ail01/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google Colabの使い方"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[s("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/0866/000000029835.jpg",width:"728",height:"90"}})]),s("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835",width:"1",height:"1"}})]),t._v(" "),s("p",[s("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[s("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/1115/000000025847.png",width:"728",height:"90"}})]),s("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847",width:"1",height:"1"}})]),t._v(" "),s("p",[s("a",{attrs:{href:"https://px.a8.net/svt/ejp?a8mat=3HIN6N+7FBNEA+4AQ0+5YJRM",rel:"nofollow"}},[t._v("全国630店舗以上！もみほぐし・足つぼ・ハンドリフレ・クイックヘッドのリラクゼーション店【りらくる】")]),s("img",{attrs:{border:"0",width:"1",height:"1",src:"https://www15.a8.net/0.gif?a8mat=3HIN6N+7FBNEA+4AQ0+5YJRM",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"google-colabのファイル構成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#google-colabのファイル構成"}},[t._v("#")]),t._v(" Google Colabのファイル構成")]),t._v(" "),s("p",[t._v("プロジェクトディレクトリはsound-separationとしています．度々，省略しています．")]),t._v(" "),s("div",{staticClass:"language-init extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sound-separation\n├── /spleeter\n│   ├── /pretrained_models <- 学習済みモデル\n│   ├── /output <- 分離後の音声\n│   └── audio_example.mp3 <- サンプル音声\n└── sound-separation.ipynb <- 実行用ノートブック\n")])])]),s("h2",{attrs:{id:"google-driveと連携"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#google-driveと連携"}},[t._v("#")]),t._v(" Google Driveと連携")]),t._v(" "),s("p",[t._v("Google ColabとGoogle Driveを連携させて，作業ディレクトリのsound-separation/spleeterを作成します．"),s("br")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Google ColabとGoogle Driveを連携")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" google"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("colab "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" drive\ndrive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/content/drive'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# %%bash")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ディレクトリの移動")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("cd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("drive"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("My\\ Drive"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sound"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("separation\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 作業ディレクトリの作成")]),t._v("\n!mkdir spleeter\n!ls\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("cd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("drive"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("My\\ Drive"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sound"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("separation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("spleeter\n!ls\n")])])]),s("h2",{attrs:{id:"ffmpeg-ibsndfileのインストール"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg-ibsndfileのインストール"}},[t._v("#")]),t._v(" ffmpeg，ibsndfileのインストール")]),t._v(" "),s("p",[t._v("オーディオファイルを扱うために，ffmpegとibsndfileをインストールします．")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("!apt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("get install ffmpeg\n!apt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("get install libsndfile"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev\n")])])]),s("h2",{attrs:{id:"モジュールのインストール"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#モジュールのインストール"}},[t._v("#")]),t._v(" モジュールのインストール")]),t._v(" "),s("p",[t._v("下記のコードでモジュールをインストールします．")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("!pip install spleeter\n")])])]),s("h2",{attrs:{id:"サンプル音声のダウンロード"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#サンプル音声のダウンロード"}},[t._v("#")]),t._v(" サンプル音声のダウンロード")]),t._v(" "),s("p",[t._v("下記のコマンドでサンプル音声をダウンロードします．")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("!wget https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("//")]),t._v("github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("deezer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("spleeter"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("raw"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("master"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("audio_example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mp3\n")])])]),s("h2",{attrs:{id:"spleeterによる音響分離"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spleeterによる音響分離"}},[t._v("#")]),t._v(" Spleeterによる音響分離")]),t._v(" "),s("p",[t._v("下記のコードでSpleeterによる音響分離を実行します．")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" spleeter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("separator "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Separator\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 出力結果の保存場所をあらかじめ作っておく")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2音源、4音源、5音源")]),t._v("\n    outdir_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./output/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'stems'")]),t._v("\n    os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("makedirs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("outdir_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exist_ok"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分離対象となる音楽wav")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# offlibertyでダウンロード")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# https://soundcloud.com/ballforest/sample")]),t._v("\ninput_audio "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"audio_example.mp3"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 初回実行時はモデルをダウンロードするため、「待ち」の時間がかかる")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 事前にダウンロードすることも可能 (pretrained_model/2stems などに保存)")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ボーカルとそれ以外に分離する(2音源)")]),t._v("\nseparator_2stem "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Separator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'spleeter:2stems'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nseparator_2stem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("separate_to_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input_audio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./output/2stems"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ボーカル、ベース、ドラムとそれ以外に分離する(4音源)")]),t._v("\nseparator_4stem "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Separator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'spleeter:4stems'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nseparator_4stem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("separate_to_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input_audio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./output/4stems"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ボーカル、ピアノ、ベース、ドラムとそれ以外に分離する(5音源)")]),t._v("\nseparator_5stem "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Separator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'spleeter:5stems'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nseparator_5stem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("separate_to_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input_audio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./output/5stems"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"_5音源での音響分離"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5音源での音響分離"}},[t._v("#")]),t._v(" 5音源での音響分離")]),t._v(" "),s("h3",{attrs:{id:"音源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#音源"}},[t._v("#")]),t._v(" 音源")]),t._v(" "),s("p",[s("audio",{attrs:{src:"/audio/audio_example/audio_example.mp3",controls:""}})]),t._v(" "),s("h3",{attrs:{id:"_5音源での音響分離-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5音源での音響分離-2"}},[t._v("#")]),t._v(" 5音源での音響分離")]),t._v(" "),s("p",[s("strong",[t._v("ヴォーカル")])]),t._v(" "),s("p",[s("audio",{attrs:{src:"/audio/audio_example/vocals.wav",controls:""}})]),t._v(" "),s("p",[s("strong",[t._v("ドラム")])]),t._v(" "),s("p",[s("audio",{attrs:{src:"/audio/audio_example/drums.wav",controls:""}})]),t._v(" "),s("p",[s("strong",[t._v("ピアノ")])]),t._v(" "),s("p",[s("audio",{attrs:{src:"/audio/audio_example/piano.wav",controls:""}})]),t._v(" "),s("p",[s("strong",[t._v("ベース")])]),t._v(" "),s("p",[s("audio",{attrs:{src:"/audio/audio_example/bass.wav",controls:""}})]),t._v(" "),s("p",[s("strong",[t._v("その他")])]),t._v(" "),s("p",[s("audio",{attrs:{src:"/audio/audio_example/other.wav",controls:""}})]),t._v(" "),s("h2",{attrs:{id:"まとめ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#まとめ"}},[t._v("#")]),t._v(" まとめ")]),t._v(" "),s("p",[t._v("Pythonで楽器と人の声を分離する音源分離を実装しました．")]),t._v(" "),s("h2",{attrs:{id:"参考サイト"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考サイト"}},[t._v("#")]),t._v(" 参考サイト")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://qiita.com/oozzZZZZ/items/496c44fcab879871a247",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Python/PyRoomAcoustics】ILRMAでブラインド音源分離"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://qiita.com/ObaShion/items/cf6fd0ede88b0c5187cb",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spleeterを使って音源分離に挑戦"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://keep-learning.hatenablog.jp/entry/2020/03/20/194403",target:"_blank",rel:"noopener noreferrer"}},[t._v("NMFとMFCCで音源分離してみよう"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[s("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/0866/000000029835.jpg",width:"728",height:"90"}})]),s("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835",width:"1",height:"1"}})]),t._v(" "),s("p",[s("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[s("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/1115/000000025847.png",width:"728",height:"90"}})]),s("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847",width:"1",height:"1"}})]),t._v(" "),s("ClientOnly",[s("CallInArticleAdsense")],1)],1)}),[],!1,null,null,null);a.default=r.exports}}]);