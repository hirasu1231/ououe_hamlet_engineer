(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{364:function(t,a,e){"use strict";e.r(a);var s=e(2),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("本稿では，音声データからテキストに変換する文字起こしを実装します．"),e("br")]),t._v(" "),e("p",[t._v("まだ精神が病んでるので，時にyoutubeで人の話を聞いて，認知療法に役立てているのですが，聞いてから文字に起こすのが面倒くさくなり，実装し始めました．"),e("br"),t._v("\nサンプルとして"),e("a",{attrs:{href:"https://pj.ninjal.ac.jp/corpus_center/csj/sample.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("コーパス開発センター音声・転記テキストサンプル"),e("OutboundLink")],1),t._v("から\n学会講演［音声］のサンプル音声(aps-smp.mp3)をダウンロードします．")]),t._v(" "),e("h2",{attrs:{id:"事前準備"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事前準備"}},[t._v("#")]),t._v(" 事前準備")]),t._v(" "),e("p",[t._v("ここではSpeechRecognitionというモジュールを用いります．googleのAPIを間接的に利用します．"),e("br"),t._v(" "),e("a",{attrs:{href:"https://cloud.google.com/speech-to-text/docs/libraries#client-libraries-install-python",target:"_blank",rel:"noopener noreferrer"}},[t._v("Speech-to-Text 公式API"),e("OutboundLink")],1)]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("pip install SpeechRecognition\n# Successfully installed SpeechRecognition-3.8.1\n")])])]),e("h2",{attrs:{id:"音声のファイル変換"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#音声のファイル変換"}},[t._v("#")]),t._v(" 音声のファイル変換")]),t._v(" "),e("p",[t._v("サンプルコードでは読み込む拡張子が「.wav」となっているため，mp3 -> wavに変換します．"),e("br"),t._v("\nファイル変換はターミナル上でffmpegで実行します．")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# ffmpegのインストール\napt-get install -y ffmpeg\n\n# ファイルの変換\nffmpeg -i aps-smp.mp3 aps-smp.wav\n")])])]),e("h2",{attrs:{id:"音声のテキスト変換"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#音声のテキスト変換"}},[t._v("#")]),t._v(" 音声のテキスト変換")]),t._v(" "),e("p",[t._v("以下のコードで音声からテキストに変換する文字起こしに実施します．")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 音声のテキスト変換")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" speech_recognition "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" sr\n \nr "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Recognizer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" sr"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AudioFile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"aps-smp.wav"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" source"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    audio "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("record"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("source"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntext "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recognize_google"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("audio"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" language"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ja-JP'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"今後のやりたいこと"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#今後のやりたいこと"}},[t._v("#")]),t._v(" 今後のやりたいこと")]),t._v(" "),e("p",[t._v("短い音声ファイルではありますが，音声からの文字起こしはできました．"),e("br"),t._v("\n今後は長い動画での文字起こし(できるだけ無料で)に実装したいです．")]),t._v(" "),e("h2",{attrs:{id:"参考サイト"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考サイト"}},[t._v("#")]),t._v(" 参考サイト")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://self-development.info/python%E3%81%A7%E9%9F%B3%E5%A3%B0%E3%81%8B%E3%82%89%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%B8%E5%A4%89%E6%8F%9B%E3%80%90speechrecognition%E3%80%91/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pythonで音声からテキストへ変換"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://qiita.com/seigot/items/62a85f1a561bb820532a",target:"_blank",rel:"noopener noreferrer"}},[t._v("MacでpythonのSpeechRecognitionを使って音声認識"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"エラーコード"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#エラーコード"}},[t._v("#")]),t._v(" エラーコード")]),t._v(" "),e("h3",{attrs:{id:"エラーコード1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#エラーコード1"}},[t._v("#")]),t._v(" エラーコード1")]),t._v(" "),e("p",[t._v("あまりに時間の長い音声ファイル(無料枠から外れる)を変換したり，言語として読み取れなかったりすると，以下のエラーが発生します．"),e("br"),t._v(" "),e("a",{attrs:{href:"https://stackoverflow.com/questions/51757824/recognize-google-speech-recognition-broken-pipe-python",target:"_blank",rel:"noopener noreferrer"}},[t._v("recognize_google speech recognition broken pipe python"),e("OutboundLink")],1)]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("RequestError: recognition connection failed: [Errno 32] Broken pipe\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);