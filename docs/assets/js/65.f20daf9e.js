(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{381:function(t,e,a){"use strict";a.r(e);var r=a(2),s=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("本稿では，音声データからテキストに変換する文字起こしを実装します．"),a("br")]),t._v(" "),a("ClientOnly",[a("CallInArticleAdsense")],1),t._v(" "),a("p",[t._v("まだ精神が病んでるので，時にyoutubeで人の話を聞いて，認知療法に役立てているのですが，聞いてから文字に起こすのが面倒くさくなり，実装し始めました．"),a("br"),t._v("\nサンプルとして"),a("a",{attrs:{href:"https://pj.ninjal.ac.jp/corpus_center/csj/sample.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("コーパス開発センター音声・転記テキストサンプル"),a("OutboundLink")],1),t._v("から\n学会講演［音声］のサンプル音声(aps-smp.mp3)をダウンロードします．")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#事前準備"}},[t._v("事前準備")])]),a("li",[a("a",{attrs:{href:"#音声のファイル変換"}},[t._v("音声のファイル変換")])]),a("li",[a("a",{attrs:{href:"#音声のテキスト変換"}},[t._v("音声のテキスト変換")])]),a("li",[a("a",{attrs:{href:"#今後のやりたいこと"}},[t._v("今後のやりたいこと")])]),a("li",[a("a",{attrs:{href:"#参考サイト"}},[t._v("参考サイト")])]),a("li",[a("a",{attrs:{href:"#エラーコード"}},[t._v("エラーコード")]),a("ul",[a("li",[a("a",{attrs:{href:"#エラーコード1"}},[t._v("エラーコード1")])])])])])]),a("p"),t._v(" "),a("p",[a("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[a("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/0866/000000029835.jpg",width:"728",height:"90"}})]),a("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835",width:"1",height:"1"}})]),t._v(" "),a("p",[a("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[a("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/1115/000000025847.png",width:"728",height:"90"}})]),a("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847",width:"1",height:"1"}})]),t._v(" "),a("h2",{attrs:{id:"事前準備"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事前準備"}},[t._v("#")]),t._v(" 事前準備")]),t._v(" "),a("p",[t._v("ここではSpeechRecognitionというモジュールを用いります．googleのAPIを間接的に利用します．"),a("br"),t._v(" "),a("a",{attrs:{href:"https://cloud.google.com/speech-to-text/docs/libraries#client-libraries-install-python",target:"_blank",rel:"noopener noreferrer"}},[t._v("Speech-to-Text 公式API"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("pip install SpeechRecognition\n# Successfully installed SpeechRecognition-3.8.1\n")])])]),a("h2",{attrs:{id:"音声のファイル変換"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#音声のファイル変換"}},[t._v("#")]),t._v(" 音声のファイル変換")]),t._v(" "),a("p",[t._v("サンプルコードでは読み込む拡張子が「.wav」となっているため，mp3 -> wavに変換します．"),a("br"),t._v("\nファイル変換はターミナル上でffmpegで実行します．")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# ffmpegのインストール\napt-get install -y ffmpeg\n\n# ファイルの変換\nffmpeg -i aps-smp.mp3 aps-smp.wav\n")])])]),a("h2",{attrs:{id:"音声のテキスト変換"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#音声のテキスト変換"}},[t._v("#")]),t._v(" 音声のテキスト変換")]),t._v(" "),a("p",[t._v("以下のコードで音声からテキストに変換する文字起こしに実施します．")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 音声のテキスト変換")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" speech_recognition "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" sr\n \nr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Recognizer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" sr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AudioFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"aps-smp.wav"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    audio "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("record"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntext "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recognize_google"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("audio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ja-JP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"今後のやりたいこと"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#今後のやりたいこと"}},[t._v("#")]),t._v(" 今後のやりたいこと")]),t._v(" "),a("p",[t._v("短い音声ファイルではありますが，音声からの文字起こしはできました．"),a("br"),t._v("\n今後は長い動画での文字起こし(できるだけ無料で)に実装したいです．")]),t._v(" "),a("h2",{attrs:{id:"参考サイト"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考サイト"}},[t._v("#")]),t._v(" 参考サイト")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://self-development.info/python%E3%81%A7%E9%9F%B3%E5%A3%B0%E3%81%8B%E3%82%89%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%B8%E5%A4%89%E6%8F%9B%E3%80%90speechrecognition%E3%80%91/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pythonで音声からテキストへ変換"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://qiita.com/seigot/items/62a85f1a561bb820532a",target:"_blank",rel:"noopener noreferrer"}},[t._v("MacでpythonのSpeechRecognitionを使って音声認識"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"エラーコード"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#エラーコード"}},[t._v("#")]),t._v(" エラーコード")]),t._v(" "),a("h3",{attrs:{id:"エラーコード1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#エラーコード1"}},[t._v("#")]),t._v(" エラーコード1")]),t._v(" "),a("p",[t._v("あまりに時間の長い音声ファイル(無料枠から外れる)を変換したり，言語として読み取れなかったりすると，以下のエラーが発生します．"),a("br"),t._v(" "),a("a",{attrs:{href:"https://stackoverflow.com/questions/51757824/recognize-google-speech-recognition-broken-pipe-python",target:"_blank",rel:"noopener noreferrer"}},[t._v("recognize_google speech recognition broken pipe python"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("RequestError: recognition connection failed: [Errno 32] Broken pipe\n")])])]),t._v(" "),a("p",[a("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[a("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/0866/000000029835.jpg",width:"728",height:"90"}})]),a("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835",width:"1",height:"1"}})]),t._v(" "),a("p",[a("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[a("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/1115/000000025847.png",width:"728",height:"90"}})]),a("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847",width:"1",height:"1"}})]),t._v(" "),a("ClientOnly",[a("CallInArticleAdsense")],1)],1)}),[],!1,null,null,null);e.default=s.exports}}]);