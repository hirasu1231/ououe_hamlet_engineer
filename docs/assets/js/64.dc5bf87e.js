(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{413:function(a,t,e){"use strict";e.r(t);var s=e(2),r=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("p",[a._v("Mac + Dockerで「ゼロからのOS自作入門」の環境構築を実装します．")]),a._v(" "),e("ClientOnly",[e("CallInArticleAdsense")],1),a._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#mac-dockerでの環境構築"}},[a._v("Mac + Dockerでの環境構築")])]),e("li",[e("a",{attrs:{href:"#xquartz"}},[a._v("XQuartz")])]),e("li",[e("a",{attrs:{href:"#vs-code-devcontaine"}},[a._v("VS Code devcontaine")])]),e("li",[e("a",{attrs:{href:"#環境構築の確認-hello-world"}},[a._v("環境構築の確認(Hello World)")]),e("ul",[e("li",[e("a",{attrs:{href:"#edk2の環境設定"}},[a._v("edk2の環境設定")])]),e("li",[e("a",{attrs:{href:"#hello-world"}},[a._v("Hello World")])])])]),e("li",[e("a",{attrs:{href:"#まとめ"}},[a._v("まとめ")])]),e("li",[e("a",{attrs:{href:"#参考サイト"}},[a._v("参考サイト")])]),e("li",[e("a",{attrs:{href:"#おまけ-用語の確認"}},[a._v("おまけ(用語の確認)")])])])]),e("p"),a._v(" "),e("p",[e("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[e("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/0866/000000029835.jpg",width:"728",height:"90"}})]),e("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835",width:"1",height:"1"}})]),a._v(" "),e("p",[e("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[e("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/1115/000000025847.png",width:"728",height:"90"}})]),e("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847",width:"1",height:"1"}})]),a._v(" "),e("h2",{attrs:{id:"mac-dockerでの環境構築"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mac-dockerでの環境構築"}},[a._v("#")]),a._v(" Mac + Dockerでの環境構築")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://zenn.dev/sarisia/articles/6b57ea835344b6",target:"_blank",rel:"noopener noreferrer"}},[a._v('Docker ではじめる "ゼロからのOS自作入門"'),e("OutboundLink")],1),a._v("に従い，VS Code Remote Container(devcontainer)を使用します．")]),a._v(" "),e("p",[a._v("VS Code Remote ContainerはVS code上でDockerのコンテナを使用する機能です．")]),a._v(" "),e("p",[a._v("仕組みとしては，環境と実行はDockerで，動作確認はローカルのXQuartzに表示させて実行します．")]),a._v(" "),e("h2",{attrs:{id:"xquartz"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#xquartz"}},[a._v("#")]),a._v(" XQuartz")]),a._v(" "),e("p",[a._v("ここでは，DockerとVS Codeのインストールは省略します．")]),a._v(" "),e("p",[a._v("以下のコマンドでXQuartzのインストールを実行します．")]),a._v(" "),e("p",[a._v("XQuartzは「/アプリケーション/ユーティリティ」ディレクトリにあるXQuartzをダブルクリックして起動します．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# XQuartzのインストール")]),a._v("\nbrew "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" xquartz\n")])])]),e("p",[a._v("XQuartzが起動すると下記のようなターミナルが表示されます．表示されない場合は，上部メニューの「アプリケーション -> ターミナル」で表示できます．")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"/image/xquartz.png",loading:"lazy"}})]),a._v(" "),e("p",[a._v("XQuartzのターミナル上で，下記のコードを実行したら準備OKです．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("xhost + "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1\n")])])]),e("h2",{attrs:{id:"vs-code-devcontaine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vs-code-devcontaine"}},[a._v("#")]),a._v(" VS Code devcontaine")]),a._v(" "),e("p",[a._v("ローカルのターミナルで以下コマンドを実行し，VS Codeが立ち上げます．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 環境構築用のgit")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/karaage0703/mikanos-devcontainer\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ディレクトリ移動")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" mikanos-devcontainer\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# VSCodeで実行")]),a._v("\ncode "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])]),e("p",[a._v("そして，VS Codeの左下の緑マークを押し，コマンドパレットで"),e("code",[a._v("Open Folder in Container...")]),a._v("を選択します.")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"/image/VS_Code1.png",loading:"lazy"}})]),a._v(" "),e("p",[a._v("しばらく待つと，以下のようなダイアログが表示されるのでmikanos-devcontainerが選ばれていることを確認してOpenをクリックしますと，環境構築が一気に済みます．")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"/image/VS_Code2.png",loading:"lazy"}})]),a._v(" "),e("h2",{attrs:{id:"環境構築の確認-hello-world"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#環境構築の確認-hello-world"}},[a._v("#")]),a._v(" 環境構築の確認(Hello World)")]),a._v(" "),e("p",[a._v("ここからは，VS Code上でのターミナルで実行します．")]),a._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"/image/VS_Code3.png",loading:"lazy"}})]),a._v(" "),e("h3",{attrs:{id:"edk2の環境設定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#edk2の環境設定"}},[a._v("#")]),a._v(" edk2の環境設定")]),a._v(" "),e("p",[a._v("「ゼロからのOS自作入門」の筆者のgitから，コードをもろもろクローンします．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mikanosのgitをclone")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /workspaces/mikanos-devcontainer/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/uchan-nos/mikanos.git\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("OS_DIR")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/workspaces/mikanos-devcontainer/mikanos\n")])])]),e("p",[a._v("そして，以下のコードでedk2の環境設定を実施します．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# edk2のディレクトリに移動")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~/edk2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mikanosのパッケージを追加")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("ln")]),a._v(" -s "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/workspace/mikanos/MikanLoaderPkg ./\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 環境変数設定用のスクリプト")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" edksetup.sh\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 設定内容情報を作業ディレクトリにコピー")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" Conf/target.txt /workspaces/mikanos-devcontainer/target.txt \n")])])]),e("h3",{attrs:{id:"hello-world"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hello-world"}},[a._v("#")]),a._v(" Hello World")]),a._v(" "),e("p",[a._v("環境構築確認のために，Hello Worldのコードを本の解説を見ながら自作するのは重たい作業なので，あらかじめクローンされている"),e("a",{attrs:{href:"https://github.com/uchan-nos/mikanos-build",target:"_blank",rel:"noopener noreferrer"}},[a._v("uchan-nos/mikanos-build"),e("OutboundLink")],1),a._v("を使用します．ディレクトリの場所は~/osbookです．")]),a._v(" "),e("p",[a._v("ここからのコードの実行は，意味を調べずに機械的に実行します．(あくまでの環境構築の確認が目的なので)")]),a._v(" "),e("p",[a._v("最初は，イメージを作ってFATでフォーマットします．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~/osbook/day01/bin\nqemu-img create -f raw disk.img 200M\nmkfs.fat -n "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'MIKAN OS'")]),a._v(" -s "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" -f "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" -R "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),a._v(" -F "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),a._v(" disk.img\n")])])]),e("p",[a._v("イメージをマウントして，バイナリファイル（hello.efi）を書き込んで，アンマウントします．")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p mnt\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("mount")]),a._v(" -o loop disk.img mnt\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p mnt/EFI/BOOT\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" hello.efi mnt/EFI/BOOT/BOOTX64.EFI\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("umount")]),a._v(" mnt\n")])])]),e("p",[a._v("バイナリファイルを書き込んだイメージをQEMUで読み込み起動します．(XQuartzに表示される)")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("qemu-system-x86_64 -drive "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("if")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("pflash,file"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/osbook/devenv/OVMF_CODE.fd -drive "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("if")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("pflash,file"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/osbook/devenv/OVMF_VARS.fd -hda disk.img\n")])])]),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"/image/xquartz_hello.png",loading:"lazy"}})]),a._v(" "),e("h2",{attrs:{id:"まとめ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#まとめ"}},[a._v("#")]),a._v(" まとめ")]),a._v(" "),e("p",[a._v("Mac + Dockerで「ゼロからのOS自作入門」の環境構築を実装しました．")]),a._v(" "),e("p",[a._v("「ゼロからのOS自作入門」を進めていく上で，弊害が出た場合は逐次修正します．")]),a._v(" "),e("h2",{attrs:{id:"参考サイト"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考サイト"}},[a._v("#")]),a._v(" 参考サイト")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://zenn.dev/sarisia/articles/6b57ea835344b6",target:"_blank",rel:"noopener noreferrer"}},[a._v('Docker ではじめる "ゼロからのOS自作入門"'),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://zenn.dev/karaage0703/articles/1bdb8930182c6c",target:"_blank",rel:"noopener noreferrer"}},[a._v("「ゼロからのOS自作入門」の副読本的記事"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/uchan-nos/mikanos",target:"_blank",rel:"noopener noreferrer"}},[a._v("uchan-nos/mikanos"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/uchan-nos/mikanos-build",target:"_blank",rel:"noopener noreferrer"}},[a._v("uchan-nos/mikanos-build"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/sarisia/mikanos-devcontainer",target:"_blank",rel:"noopener noreferrer"}},[a._v("sarisia/mikanos-devcontainer"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/sarisia/mikanos-docker",target:"_blank",rel:"noopener noreferrer"}},[a._v("sarisia/mikanos-docker"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/bun913/go_devcontainer",target:"_blank",rel:"noopener noreferrer"}},[a._v("bun913/go_devcontainer"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://zero.osdev.jp/",target:"_blank",rel:"noopener noreferrer"}},[a._v("「ゼロからのOS自作入門」のサポートサイト"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://itcweb.cc.affrc.go.jp/affrit/documents/guide/x-window/x-win-mac",target:"_blank",rel:"noopener noreferrer"}},[a._v("4 macOSでのX Window利用"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[e("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/0866/000000029835.jpg",width:"728",height:"90"}})]),e("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2604050&p_id=1555&pc_id=2816&pl_id=29835",width:"1",height:"1"}})]),a._v(" "),e("p",[e("a",{attrs:{href:"//af.moshimo.com/af/c/click?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847&guid=ON",rel:"nofollow",referrerpolicy:"no-referrer-when-downgrade"}},[e("img",{staticStyle:{border:"none"},attrs:{src:"//image.moshimo.com/af-img/1115/000000025847.png",width:"728",height:"90"}})]),e("img",{staticStyle:{border:"none"},attrs:{src:"//i.moshimo.com/af/i/impression?a_id=2641145&p_id=1770&pc_id=3386&pl_id=25847",width:"1",height:"1"}})]),a._v(" "),e("ClientOnly",[e("CallInArticleAdsense")],1),a._v(" "),e("h2",{attrs:{id:"おまけ-用語の確認"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#おまけ-用語の確認"}},[a._v("#")]),a._v(" おまけ(用語の確認)")]),a._v(" "),e("p",[a._v("EDKⅡ")]),a._v(" "),e("blockquote",[e("p",[a._v("EDKⅡはUEFI BIOS自体の開発にも，UEFI BIOS上で動くアプリケーションの開発にも使うことができる開発キット"),e("br"),a._v("\n引用元:[「ゼロからのOS自作入門」p48]")])]),a._v(" "),e("p",[a._v("UEFI(Unified Extensible Firmware Interface) or UEFI BIOS")]),a._v(" "),e("blockquote",[e("p",[a._v("UEFIとは、一言で言うと「最近のPCやサーバーに入っている、新しくて高機能なファームウェア(及びそのインターフェースの仕様)」です。"),e("br"),a._v("\n体感では、2世代目Core iシリーズのCPU以降が入っているマシンには、このUEFIが従来のBIOS(以降、BIOSと表記)の代わりに、または選択可能な状態で入っているように感じています。"),e("br"),a._v("\n引用元:"),e("a",{attrs:{href:"https://qiita.com/tnishinaga/items/40755f414557faf45dcb",target:"_blank",rel:"noopener noreferrer"}},[a._v("gnu-efiでUEFI遊びをはじめよう"),e("OutboundLink")],1)])]),a._v(" "),e("p",[a._v("BIOS(Basic Input / Output System)")]),a._v(" "),e("blockquote",[e("p",[a._v("BIOSは「Basic Input/Output System」の略で、CPUやメモリ、キーボード、マウスなどPCの大半の機能を制御しています。PCを起動したとき最初に作動するのがBIOSで、OSやソフトウェアとの橋渡しをする役割を担っています。"),e("br"),a._v("\n引用元:"),e("a",{attrs:{href:"https://pc-farm.co.jp/pc_column/pc/4351/",target:"_blank",rel:"noopener noreferrer"}},[a._v("BIOSとUEFIの違いについて詳しく解説！次世代のレガシーBIOSとは？"),e("OutboundLink")],1)])]),a._v(" "),e("p",[a._v("UEFI BIOSと従来のBIOSの違いについて")]),a._v(" "),e("blockquote",[e("ol",[e("li",[a._v("2 TB以上のドライブを処理できます。それに対して、古いレガシーBIOSは大容量のストレージドライブを処理できませんでした。")]),a._v(" "),e("li",[a._v("GUIDパーティションテーブルで4つ以上のプライマリパーティションが作成可能です。")]),a._v(" "),e("li",[a._v("BIOSより起動プロセスが高速です。UEFIの最適化により、システムの起動がより速くなる可能性があります。安全な起動をサポートしています。つまり、オペレーティングシステムの有効性の検証によって、起動プロセスを改ざんするマルウェアがないことを確認できます。")]),a._v(" "),e("li",[a._v("UEFIファームウェア自体のネットワーク機能をサポートして、リモートトラブルシューティングとUEFI構成に役立ちます。")]),a._v(" "),e("li",[a._v("グラフィカルユーザーインターフェイスはシンプルで、レガシーBIOSよりも豊富なセットアップメニューがあります。"),e("br"),a._v(" "),e("br"),a._v("\n引用元:"),e("a",{attrs:{href:"https://www.partitionwizard.jp/partitionmagic/uefi-vs-bios.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("UEFIとBIOS、どっちがいい？"),e("OutboundLink")],1),e("br"),a._v("\nより詳細に:"),e("a",{attrs:{href:"https://knowledge.sakura.ad.jp/22963/",target:"_blank",rel:"noopener noreferrer"}},[a._v("現代における自作OSの難しさ 〜自作OSのいまと昔 [第2回]"),e("OutboundLink")],1)])])])],1)}),[],!1,null,null,null);t.default=r.exports}}]);